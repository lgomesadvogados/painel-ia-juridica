<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Painel IA Jur√≠dica - L Gomes</title>
  <style>
    body {
      background-color: #000;
      color: #ffd700;
      font-family: Arial, sans-serif;
      padding: 20px;
    }
    .agent, .alert, .admin-section {
      border: 1px solid #ffd700;
      margin: 10px 0;
      padding: 10px;
    }
    textarea {
      width: 100%;
      height: 60px;
      background-color: #111;
      color: #ffd700;
      border: 1px solid #444;
      margin-top: 5px;
    }
    button {
      margin: 5px;
    }
    .hidden { display: none; }
  </style>
</head>
<body>
  <h1>Integra√ß√£o IA Jur√≠dica - L Gomes Advogados</h1>

  <div class="admin-section">
    <h2>Treinamento dos Agentes (Administrador)</h2>
    <label>Senha de administrador: <input type="password" id="admin-pass"></label>
    <button onclick="habilitarTreinamento()">Liberar Edi√ß√£o</button>

    <div id="trainers" class="hidden">
      <p>Digite instru√ß√µes personalizadas para cada agente:</p>
      <div><strong>1. Assistente Jur√≠dico:</strong><textarea id="t1"></textarea></div>
      <div><strong>2. Estagi√°rio IA:</strong><textarea id="t2"></textarea></div>
      <div><strong>3. Analista Jur√≠dico:</strong><textarea id="t3"></textarea></div>
      <div><strong>4. Auditor Jur√≠dico:</strong><textarea id="t4"></textarea></div>
      <div><strong>5. Protocolista:</strong><textarea id="t5"></textarea></div>
    </div>
  </div>

  <button onclick="iniciarCaso()">‚ñ∂Ô∏è Iniciar Novo Caso</button>
  <button onclick="pausarFluxo()">‚è∏Ô∏è Pausar Agentes</button>
  <button onclick="retomarFluxo()">‚ñ∂Ô∏è Retomar Agentes</button>

  <div id="notificacoes"></div>
  <div id="chat-log" class="agent"></div>

  <div class="agent">
    <button onclick="salvarCaso()">üíæ Salvar Caso (.txt)</button>
    <button onclick="encerrarCaso()">‚úÖ Encerrar Caso</button>
  </div>

  <script>
    const API_KEY = "SUA-CHAVE-AQUI"; // Coloque sua chave aqui

    let pausado = false;
    let fluxo = [];

    function log(agente, msg) {
      const div = document.createElement("div");
      div.innerHTML = `<strong>${agente}:</strong> ${msg}`;
      document.getElementById("chat-log").appendChild(div);
    }

    function notificar(mensagem, destinatario) {
      const div = document.createElement("div");
      div.className = "alert";
      div.innerHTML = `üîî <strong>Notifica√ß√£o para ${destinatario}:</strong> ${mensagem}`;
      document.getElementById("notificacoes").appendChild(div);
    }

    function habilitarTreinamento() {
      const pass = document.getElementById("admin-pass").value;
      if (pass === "admin123") {
        document.getElementById("trainers").classList.remove("hidden");
      } else {
        alert("Senha incorreta.");
      }
    }

    function pausarFluxo() {
      pausado = true;
      notificar("Todos os agentes foram pausados.", "Auditor Jur√≠dico");
    }

    function retomarFluxo() {
      pausado = false;
      notificar("Fluxo de agentes retomado.", "Auditor Jur√≠dico");
    }

    async function enviarPrompt(agente, prompt) {
      if (pausado) return `${agente} est√° em pausa.`;
      const response = await fetch("https://api.openai.com/v1/chat/completions", {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
          "Authorization": `Bearer ${API_KEY}`
        },
        body: JSON.stringify({
          model: "gpt-4",
          messages: [{ role: "user", content: prompt }]
        })
      });

      const data = await response.json();
      const resposta = data.choices[0].message.content;
      fluxo.push(`\n[${agente}]\n${resposta}`);
      log(agente, resposta);
      return resposta;
    }

    async function iniciarCaso() {
      fluxo = [];
      document.getElementById("chat-log").innerHTML = "";
      document.getElementById("notificacoes").innerHTML = "";

      const p1 = document.getElementById("t1").value || "Analise detalhadamente o caso com base em doutrina e legisla√ß√£o.";
      const p2 = document.getElementById("t2").value || "Com base na an√°lise anterior, elabore a peti√ß√£o.";
      const p3 = document.getElementById("t3").value || "Revise o documento, adapte ao padr√£o do escrit√≥rio.";
      const p4 = document.getElementById("t4").value || "Comunique d√∫vidas, pausas e limites. Notifique Dra. Lorrana se necess√°rio.";
      const p5 = document.getElementById("t5").value || "Resuma e notifique Dr. Thiago. S√≥ encerre com comando.";

      const out1 = await enviarPrompt("Assistente Jur√≠dico", p1);
      const out2 = await enviarPrompt("Estagi√°rio de IA", `${p2}\n${out1}`);
      const out3 = await enviarPrompt("Analista Jur√≠dico", `${p3}\n${out2}`);
      const out4 = await enviarPrompt("Auditor Jur√≠dico", `${p4}\n${out3}`);
      notificar("Avaliar resposta do Auditor Jur√≠dico.", "Dra. Lorrana");

      const out5 = await enviarPrompt("Protocolista", `${p5}\n${out4}`);
      notificar("Pronto para protocolo. Aguardar comando do Dr. Thiago.", "Protocolista");
    }

    function salvarCaso() {
      const blob = new Blob([fluxo.join("\n")], { type: "text/plain" });
      const a = document.createElement("a");
      a.href = URL.createObjectURL(blob);
      a.download = "caso_lgomes.txt";
      a.click();
    }

    function encerrarCaso() {
      notificar("Caso encerrado por comando do Dr. Thiago.", "Sistema");
    }
  </script>
</body>
</html>
